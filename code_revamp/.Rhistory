library(ggplot2)
library(ggplot2)
library(ggrepel)
library(ggplot2)
library(ggrepel)
library(ggsci)
library(cowplot)
library(reshape2)
library(sva)
library(sva)
library(DESeq2)
library(vegan)
library(DescTools)
setwd("/media/barbitoff/DATA/Working issues/BI_Science/Lubeck/TCR")
set.seed(100)
tra_data <- read.table('human_TRA_overlapbrowser_wasp.tsv', sep='\t', header=T)
trb_data <- read.table('human_TRB_overlapbrowser_wasp.tsv', sep='\t', header=T)
colnames(tra_data)
tra_meta <- read.table('tra_wasp_patiens.tsv', sep='\t', header=T)
trb_meta <- read.table('trb_wasp_patiens.tsv', sep='\t', header=T)
head(trb_meta)
tra_meta$ID = gsub('hT', 'HT', tra_meta$ID)
trb_meta$ID = gsub('hT', 'HT', trb_meta$ID)
tra_fractions = tra_data[, grepl('CLONE.FRACTION.', colnames(tra_data))]
colnames(tra_fractions) = gsub('CLONE.FRACTION.', '', colnames(tra_fractions))
tra_counts = tra_data[, grepl('CLONE.COUNT.', colnames(tra_data))]
colnames(tra_counts) = gsub('CLONE.COUNT.', '', colnames(tra_counts))
head(tra_counts)
trb_fractions = trb_data[, grepl('CLONE.FRACTION.', colnames(trb_data))]
colnames(trb_fractions) = gsub('CLONE.FRACTION.', '', colnames(trb_fractions))
trb_counts = trb_data[, grepl('CLONE.COUNT.', colnames(trb_data))]
colnames(trb_counts) = gsub('CLONE.COUNT.', '', colnames(trb_counts))
tra_fractions[is.na(tra_fractions)] = 0
tra_counts[is.na(tra_counts)] = 0
trb_fractions[is.na(trb_fractions)] = 0
trb_counts[is.na(trb_counts)] = 0
tra_frac_agg = data.frame(ID=colnames(tra_fractions),
total=colSums(tra_fractions))
tra_frac_agg$visit = as.character(sapply(tra_frac_agg$ID,
function(x) as.character(tra_meta[tra_meta$ID == x, 'visite'])))
tra_frac_agg$Type = 'TRA'
trb_frac_agg = data.frame(ID=colnames(trb_fractions),
total=colSums(trb_fractions))
trb_frac_agg$visit = as.character(sapply(trb_frac_agg$ID,
function(x) as.character(trb_meta[trb_meta$ID == x, 'visite'])))
trb_frac_agg$Type = 'TRB'
tcr_frac_agg = as.data.frame(rbind(tra_frac_agg, trb_frac_agg))
tcr_frac_agg = tcr_frac_agg[tcr_frac_agg$visit != "3", ]
ggplot(tcr_frac_agg, aes(x=Type, y=total, fill=visit)) + geom_boxplot() +
theme_bw()
sum(apply(tra_counts, 1, function(x) x > 20))
apply(tra_counts, 1, function(x) x > 20
)
table(apply(tra_counts, 1, function(x) x > 20)
)
table(apply(tra_counts, 1, function(x) sum(x > 0) > 20))
table(apply(tra_counts, 1, function(x) sum(x > 0) > 25))
hist(apply(tra_counts, 1, function(x) sum(x > 0)))
log(0.36/0.00005, base=1.00000001)
log(0.001/0.00005, base=1.00000001)
log(0.0001/0.00005, base=1.00000001)
log(0.00008/0.00005, base=1.00000001)
a <- matrix(c(29037, 20733, 4872, 28402, 21982, 4253), nrow=2, byrow=T)
a
chisq.test(a)
?phyper()
fisher.test(matrix(c(5, 1, 4, 8), nrow=2, byrow=T))
?siher.test
?dsiher.test
?fsiher.test
?fisher.test
phyper(5, m=6, n=6, k=6)
phyper(5, m=6, n=6, k=6, lower.tail = T)
phyper(5, m=6, n=6, k=6, lower.tail = F)
phyper(0, m=6, n=6, k=2, lower.tail = F)
phyper(1, m=6, n=6, k=4, lower.tail = F)
phyper(4, m=6, n=6, k=4, lower.tail = F)
dhyper(4, m=6, n=6, k=4)
dhyper(5, m=6, n=6, k=6)
dhyper(0, m=6, n=6, k=2)
dhyper(1 m=6, n=6, k=4)
dhyper(1, m=6, n=6, k=4)
1 = phyper(5, m=6, n=6, k=6)
1 - phyper(5, m=6, n=6, k=6)
1 - phyper(4, m=6, n=6, k=4)
1 - phyper(3, m=6, n=6, k=4)
1 - phyper(4, m=6, n=6, k=6)
1 - phyper(0, m=6, n=6, k=4)
1 - phyper(4, m=6, n=6, k=5)
1 - phyper(0, m=6, n=6, k=2)
1 - phyper(-1, m=6, n=6, k=1)
1 - phyper(0, m=6, n=6, k=3)
chisq.test(matrix(c(148, 8800, 30, 1232), nrow=2, byrow=T))
a <- c('AAA;BBB', 'CCC;DDD')
sapply(a, function(x) strsplit(x, ';'))
sapply(a, function(x) strsplit(x, ';')[[1]])
c(sapply(a, function(x) strsplit(x, ';')[[1]]))
unique(c(sapply(a, function(x) strsplit(x, ';')[[1]])))
?phyper
phyper(1, m=10, n=10, k=10)
rhyper(m=5, n=15, k=3)
rhyper(m=5, n=15, k=3, nn=100)
drawn <- rhyper(m=5, n=15, k=3, nn=1000)
pvals = sapply(drawn, function(x) phyper(x, m=10, n=10, k=10))
hist(pvals)
pvals = sapply(drawn, function(x) phyper(x, m=10, n=10, k=10, lower.tail=FALSE))
hist(pvals)
pvals = sapply(drawn, function(x) phyper(x, m=5, n=15, k=3, lower.tail=FALSE))
hist(pvals)
min(pvals * length(pvals))
pvals = sapply(drawn, function(x) phyper(x, m=5, n=15, k=3, lower.tail=TRUE))
min(pvals * length(pvals))
table(pvals * length(pvals) < 0.05)
table(pvals[drawn >= 1] * length(pvals[drawn >= 1]) < 0.05)
pvals = sapply(drawn, function(x) phyper(x, m=5, n=15, k=3, lower.tail=TRUE))
drawn <- rhyper(m=5, n=15, k=3, nn=1000)
pvals = sapply(drawn, function(x) phyper(x, m=5, n=15, k=3, lower.tail=TRUE))
table(pvals * length(pvals) < 0.05)
table(pvals[drawn >= 1] * length(pvals[drawn >= 1]) < 0.05)
drawn <- rhyper(m=5, n=15, k=3, nn=1000)
pvals = sapply(drawn, function(x) phyper(x, m=5, n=15, k=3, lower.tail=TRUE))
table(pvals * length(pvals) < 0.05)
table(pvals[drawn >= 1] * length(pvals[drawn >= 1]) < 0.05)
drawn <- rhyper(m=5, n=15, k=3, nn=1000)
pvals = sapply(drawn, function(x) phyper(x, m=5, n=15, k=3, lower.tail=TRUE))
table(pvals * length(pvals) < 0.05)
table(pvals[drawn >= 1] * length(pvals[drawn >= 1]) < 0.05)
table(p.adjust(pvals, method='fdr') < 0.05)
table(p.adjust(pvals[drawn >= 1], method='fdr') < 0.05)
drawn <- rhyper(m=100, n=19900, k=20, nn=1000)
pvals = sapply(drawn, function(x) phyper(x, m=100, n=19900, k=20, lower.tail=TRUE))
table(p.adjust(pvals, method='fdr') < 0.05)
table(p.adjust(pvals[drawn >= 1], method='fdr') < 0.05)
drawn <- rhyper(m=100, n=19900, k=20, nn=1000)
pvals = sapply(drawn, function(x) phyper(x, m=100, n=19900, k=20, lower.tail=TRUE))
table(p.adjust(pvals, method='fdr') < 0.05)
table(p.adjust(pvals[drawn >= 1], method='fdr') < 0.05)
drawn <- rhyper(m=100, n=19900, k=20, nn=1000000)
pvals = sapply(drawn, function(x) phyper(x, m=100, n=19900, k=20, lower.tail=TRUE))
table(p.adjust(pvals, method='fdr') < 0.05)
table(p.adjust(pvals[drawn >= 1], method='fdr') < 0.05)
drawn <- rhyper(m=100, n=19900, k=20, nn=1000000)
pvals = sapply(drawn, function(x) phyper(x, m=100, n=19900, k=20, lower.tail=TRUE))
table(p.adjust(pvals, method='fdr') < 0.1)
table(p.adjust(pvals[drawn >= 1], method='fdr') < 0.1)
hist(pvals)
hist(-log(pvals, 19))
hist(-log(pvals, 10))
hist(-log(pvals, 10))
pvals[1:10]
pvals[1:10]
pvals[1:10]
hist(drawn)
hist(p.adjust(pvals, method='fdr'))
hist(p.adjust(pvals[drawn >= 1], method='fdr'))
hist(p.adjust(pvals, method='fdr'))
hist(p.adjust(pvals[drawn >= 1], method='fdr'))
pvals = sapply(drawn, function(x) phyper(x, m=100, n=19900, k=20, lower.tail=FALSE))
table(p.adjust(pvals, method='fdr') < 0.1)
table(p.adjust(pvals[drawn >= 1], method='fdr') < 0.1)
drawn <- rhyper(m=100, n=19900, k=20, nn=1000000)
hist(drawn)
library(htmlwidgets)
library(Hmisc)
install.packages("Hmisc")
BiocManager::install("Hmisc")
BiocManager::install("Hmisc")
install.packages("Hmisc")
install.packages("Hmisc",repos = "http://cran.us.r-project.org")
seq(0, 1, 0.001)
fst = data.frame(p_a = seq(0, 1, 0.001), p_b = seq(0, 1, 0.001), fst=rep(NA, 1001))
get_fst <- function(f_a, f_b) {
h_a = 2 * f_a * (1 - f_a)
h_b = 2 * f_b * (1 - f_b)
h_w = mean(c(h_a, h_b))
f_t = mean(c(f_a, f_b))
h_t = 2 * f_t * (1 - f_t)
ret_val = (h_t - h_w) / h_t
return(ret_val)
}
fst$fst = apply(fst, 1, function(x) get_fst(x[1], x[2]))
View(fst)
library(ggplot2)
fst = data.frame(p_a = rep(seq(0, 1, 0.01), 100),
p_b = rep(seq(0, 1, 0.01), each=100)
, fst=rep(NA, 101 * 101))
fst = data.frame(p_a = rep(seq(0, 1, 0.01), 101),
p_b = rep(seq(0, 1, 0.01), each=101)
, fst=rep(NA, 101 * 101))
fst$fst = apply(fst, 1, function(x) get_fst(x[1], x[2]))
ggplot(fst, aes(x=p_a, y=p_b, fill=fst)) + geom_tile()
library(colorRamps)
jet = matlab.like2(100)
ggplot(fst, aes(x=p_a, y=p_b, fill=fst)) + geom_tile() +
scale_fill_gradient(jet)
ggplot(fst, aes(x=p_a, y=p_b, fill=fst)) + geom_tile() +
scale_fill_manual(values=jet)
ggplot(fst, aes(x=p_a, y=p_b, fill=fst)) + geom_tile() +
scale_fill_gradient(colourss=jet)
ggplot(fst, aes(x=p_a, y=p_b, fill=fst)) + geom_tile() +
scale_fill_gradient(colourss=matlab.like2())
ggplot(fst, aes(x=p_a, y=p_b, fill=fst)) + geom_tile() +
scale_fill_brewer()
ggplot(fst, aes(x=p_a, y=p_b, fill=fst)) + geom_tile() +
scale_fill_gradientn(jet)
ggplot(fst, aes(x=p_a, y=p_b, fill=fst)) + geom_tile() +
scale_fill_gradientn(colors=jet)
fst$fold_diff = apply(fst, 1, function(x) max(x[1], x[2])/min(x[1], x[2]))
max(1, 5, 1)
max(1, 5, 11)
fst$fold_diff = round(apply(fst, 1, function(x) max(x[1], x[2])/min(x[1], x[2])),
digits=0)
View(fst)
fst$fold_diff[fst$fold_diff == Inf] = NA
ggplot(fst, aes(x=fold_diff, y=fst)) + geom_bpxplot()
ggplot(fst, aes(x=fold_diff, y=fst)) + geom_boxplot()
fst$fold_diff = as.factor(fst$fold_diff)
ggplot(fst, aes(x=fold_diff, y=fst)) + geom_boxplot()
fst$fold_diff = round(apply(fst, 1, function(x) max(x[1], x[2])/min(x[1], x[2])),
digits=0)
head(fst)
tail(fst)
fst = data.frame(p_a = rep(seq(0, 1, 0.01), 101),
p_b = rep(seq(0, 1, 0.01), each=101)
, fst=rep(NA, 101 * 101))
fst$fst = apply(fst, 1, function(x) get_fst(x[1], x[2]))
fst$fold_diff = round(apply(fst, 1, function(x) max(x[1], x[2])/min(x[1], x[2])),
digits=0)
fst_flt = fst[fst$fold_diff <= 10, ]
fst_flt$fold_diff[fst_flt$fold_diff == Inf] = NA
fst_flt$fold_diff = as.factor(fst_flt$fold_diff)
ggplot(fst_flt, aes(x=fold_diff, y=fst)) + geom_boxplot()
ggplot(na.omit(fst_flt), aes(x=fold_diff, y=fst)) + geom_boxplot()
pvals = c(6.3862169E-4, 1.6495452E-3, 9.66801758E-3, 2.30209506E-2, 2.71077635E-2, 2.92453451E-2, 3.4529937E-2, 3.61495064E-2, 3.80535413E-2, 4.0514776E-2, 4.2377231E-2, 4.44505018E-2, 4.54251786E-2, 4.72643817E-2, 4.92666642E-2, 5.09329991E-2, 5.58897764E-2, 6.12444015E-2, 6.30772358E-2, 6.40474706E-2, 7.18215184E-2, 8.04201406E-2, 8.06496292E-2, 9.36027976E-2, 9.44962936E-2, 9.49029646E-2, 9.57676339E-2, 9.69859995E-2, 1.06673093E-1, 1.10556116E-1, 1.11220955E-1, 1.17100733E-1, 1.22241062E-1, 1.28852461E-1, 1.29975388E-1, 1.3865064E-1, 1.52677646E-1, 1.54441108E-1, 1.57938179E-1, 1.64138668E-1, 1.68330444E-1, 1.69167908E-1, 1.74185051E-1, 1.79098562E-1, 1.7931446E-1, 1.85629638E-1, 1.93775674E-1, 1.9677448E-1, 1.98470171E-1, 2.19778702E-1, 2.2098568E-1, 2.27897786E-1, 2.39263669E-1, 2.4316698E-1, 2.47074405E-1, 2.5233287E-1, 2.52376203E-1, 2.55592407E-1, 2.56206995E-1, 2.57125319E-1, 2.58396268E-1, 2.61842285E-1, 2.67609043E-1, 2.71553762E-1, 2.74430188E-1, 2.79459801E-1, 2.79944646E-1, 2.86401207E-1, 2.91948676E-1, 2.92746381E-1, 2.93046603E-1, 3.01607298E-1, 3.07631814E-1, 3.08868909E-1, 3.1053307E-1, 3.20107136E-1, 3.22529506E-1, 3.23608198E-1, 3.28177722E-1, 3.29558657E-1, 3.30789871E-1, 3.36609828E-1, 3.40570712E-1, 3.42535913E-1, 3.62587249E-1, 3.65966286E-1, 3.67914058E-1, 3.68796562E-1, 3.72639869E-1, 3.77124206E-1, 3.84007434E-1, 3.87564375E-1, 3.99972415E-1, 4.00177269E-1, 4.03166233E-1, 4.05148675E-1, 4.08293927E-1, 4.19679244E-1, 4.19864425E-1, 4.29244268E-1, 4.32472807E-1, 4.33502115E-1, 4.36692121E-1, 4.37992163E-1, 4.42132187E-1, 4.43462447E-1, 4.4458411E-1, 4.49612386E-1, 4.50640024E-1, 4.56106809E-1, 4.79505248E-1, 4.79631833E-1, 4.86973221E-1, 4.9298046E-1, 4.93298694E-1, 5.08124484E-1, 5.09321244E-1, 5.15734888E-1, 5.20730064E-1, 5.22841961E-1, 5.36187423E-1, 5.39731037E-1, 5.52080651E-1, 5.61841433E-1, 5.64558068E-1, 5.73412369E-1, 5.82455624E-1, 5.8380458E-1, 6.1697363E-1, 6.18119279E-1, 6.19630924E-1, 6.19759907E-1, 6.28689076E-1, 6.31635335E-1, 6.60716155E-1, 6.88447912E-1, 6.98078009E-1, 7.0658187E-1, 7.14357542E-1, 7.14685238E-1, 7.16183819E-1, 7.17337346E-1, 7.20679466E-1, 7.27846031E-1, 7.27943288E-1, 7.28234122E-1, 7.32483445E-1, 7.36466693E-1, 7.40774517E-1, 7.42989936E-1, 7.57466614E-1, 7.59650976E-1, 7.61543879E-1, 7.71826553E-1, 7.76731726E-1, 7.78227427E-1, 7.92522164E-1, 8.0093584E-1, 8.04365295E-1, 8.29063932E-1, 8.32852896E-1, 8.39110729E-1, 8.42079018E-1, 8.47101116E-1, 8.47793148E-1, 8.53373574E-1, 8.82723316E-1, 8.85557865E-1, 8.87899326E-1, 8.99853623E-1, 9.0932693E-1, 9.09554917E-1, 9.18377836E-1, 9.27880537E-1, 9.30730337E-1, 9.47829255E-1, 9.5049033E-1, 9.51406349E-1, 9.55030628E-1, 9.72838207E-1, 9.74303929E-1, 9.75293493E-1, 9.89160963E-1, 9.90853393E-1, 9.92596956E-1, 9.96835023E-1)
p.adjust(pvals, method='fdr')
min(p.adjust(pvals, method='fdr'))
a <- matrix(c(43, 65, 264, 226), nrow=2, byrow=T)
chisq.test(a)
a <- matrix(c(43, 65, 295, 231), nrow=2, byrow=T)
chisq.test(a)
f508_yugra_central <- matrix(c(43, 65, 839, 771), nrow=2, byrow=T)
chisq.test(f508_yugra_central)
f508_all <- matrix(c(43, 65, 264, 226, 295, 231, 839, 771), nrow=2, byrow=T)
f508_all
f508_all <- matrix(c(43, 65, 264, 226, 295, 231, 839, 771), nrow=4, byrow=T)
f508_all
chisq.test(f508_all)
assocplot(f508_all)
rownames(f508_all) <- c('Yugra', 'Ural', 'North-West', 'Central')
colnames(f508_all) <- c('F509del', 'other')
f508_all
chisq.test(f508_all)
assocplot(f508_all)
resid(f508_all)
chisq.test(f508_all)$residual
assocplot(t(f508_all))
f508_dele23_all <- matrix(c(43, 5, 60,
264, 24, 202,
295, 26, 205,
839, 165, 645), nrow=4, byrow=T)
f508_dele23_all
chisq.test(f508_dele23_all)
chisq.test(f508_dele23_all)$residual
assocplot(t(f508_dele23_all))
rownames(f508_all) <- c('Yugra', 'Ural', 'North-West', 'Central')
colnames(f508_all) <- c('F509del', 'CFTRdele2,3', 'other')
rownames(f508_dele23_all) <- c('Yugra', 'Ural', 'North-West', 'Central')
colnames(f508_dele23_all) <- c('F509del', 'CFTRdele2,3', 'other')
f508_dele23_all
chisq.test(f508_dele23_all)$residual
assocplot(t(f508_dele23_all))
# F508 and CFTRdele2,3 combined test
f508_dele23_all <- matrix(c(43, 5, 60,
264, 24, 202,
295, 26, 205,
839, 126, 645), nrow=4, byrow=T)
rownames(f508_dele23_all) <- c('Yugra', 'Ural', 'North-West', 'Central')
colnames(f508_dele23_all) <- c('F509del', 'CFTRdele2,3', 'other')
f508_dele23_all
chisq.test(f508_dele23_all)
chisq.test(f508_dele23_all)$residual
# CFTRdele2,3 all regions
dele23_all <- matrix(c(5, 103, 24, 466, 26, 500, 126, 1484), nrow=4, byrow=T)
rownames(dele23_all) <- c('Yugra', 'Ural', 'North-West', 'Central')
colnames(dele23_all) <- c('F509del', 'CFTRdele2,3', 'other')
colnames(dele23_all) <- c('CFTRdele2,3', 'other')
f508_dele23_all
dele23_all
chisq.test(dele23_all)
chisq.test(dele23_all)$residual
# L138ins
l138ins_all <- matrix(c(14, 476, 6, 520, 31, 1579), nrow=3, byrow=T)
rownames(l138ins_all) <- c('Ural', 'North-West', 'Central')
colnames(l138ins_all) <- c('L138ins', 'other')
l138ins_all
chisq.test(l138ins_all)
chisq.test(l138ins_all)$residual
chisq.test(f508_dele23_all)$residual
library(binom)
install.packages("binom")
library(binom)
binom.confint(27, 3342)
binom.confint(27, 3342, method='exact')
binom.confint(27, 3342, method='exact', conf.level = 0.9)
binom.confint(81, 12902, method='exact', conf.level = 0.95)
binom.confint(81, 12902, method='exact', conf.level = 0.9)
# L138ins
binom.confint(2, 3342, method='exact', conf.level = 0.9)
# All variants from the table
binom.confint(37, 3342, method='exact', conf.level = 0.9)
# RUSeq all
binom.confint(81, 12902, method='exact', conf.level = 0.9)
# Abramov et al.
binom.confint(15, 2000, method='exact', conf.level = 0.9)
binom.confint(107, 12902, method='exact', conf.level = 0.9)
# Abramov et al.
binom.confint(24, 2000, method='exact', conf.level = 0.9)
f508_all <- matrix(c(43, 65, 264, 226, 295, 231, 839, 771), nrow=4, byrow=T)
rownames(f508_all) <- c('Yugra', 'Ural', 'North-West', 'Central')
colnames(f508_all) <- c('F509del', 'other')
f508_all
chisq.test(f508_all)
chisq.test(f508_all)$residual
f508_all_wspb <- matrix(c(43, 65, 264, 226, 295, 231, 839, 771, 2846, 4824-2846),
nrow=5, byrow=T)
f508_all_wspb
chisq.test(f508_all_wspb)
chisq.test(f508_all_wspb)$residual
### Testing the regional differences (in different combinations)
# F508 pairwise and total
f508_yugra_sob <- matrix(c(43, 65, 2846, 1978), nrow=2, byrow=T)
f508_yugra_sob
chisq.test(f508_yugra_sob)
chisq.test(f508_yugra_sob)$residual
rownames(f508_reg) <- c('Ural', 'North-West', 'Central')
f508_reg <- matrix(c(264, 226, 295, 231, 839, 771), nrow=4, byrow=T)
f508_reg <- matrix(c(264, 226, 295, 231, 839, 771), nrow=3, byrow=T)
rownames(f508_reg) <- c('Ural', 'North-West', 'Central')
colnames(f508_reg) <- c('F509del', 'other')
f508_reg
chisq.test(f508_reg)
4824-178
# CFTRdele2,3
# Pairwise Yugra vs. SPb
dele23_yugra_sob <- matrix(c(5, 103, 178, 4646), nrow=2, byrow=T)
dele23_yugra_sob
chisq.test(dele23_yugra_sob)
# dele2,3 registry (regions)
dele23_reg <- matrix(c(24, 466, 26, 500, 126, 1484), nrow=3, byrow=T)
rownames(dele23_reg) <- c('Ural', 'North-West', 'Central')
colnames(dele23_reg) <- c('CFTRdele2,3', 'other')
dele23_reg
chisq.test(dele23_reg)
chisq.test(dele23_reg)$residual
# F508 and CFTRdele2,3 combined test
f508_dele23_reg <- matrix(c(264, 24, 202,
295, 26, 205,
839, 126, 645), nrow=3, byrow=T)
rownames(f508_dele23_reg) <- c('Ural', 'North-West', 'Central')
colnames(f508_dele23_reg) <- c('F509del', 'CFTRdele2,3', 'other')
f508_dele23_reg
chisq.test(f508_dele23_reg)
chisq.test(f508_dele23_reg)$residual
# F508 and CFTRdele2,3 combined test
f508_dele23_yugra_sob <- matrix(c(43, 5, 60, 2846, 178, 1900), nrow=2, byrow=T)
f508_dele23_yugra_sob
rownames(f508_dele23_yugra_sob) = c('Yugra', 'SPb')
colnames(f508_dele23_yugra_sob) <- c('F509del', 'CFTRdele2,3', 'other')
chisq.test(f508_dele23_yugra_sob)
chisq.test(f508_dele23_yugra_sob)$residual
# F508 RUSeq vs infertile
f508_if_ac = round(0.0152 * 12066, digits=0)
f508_ruseq_inf <- matrix(c(27, 3342, f508_if_ac, 12066 - f508_if_ac), nrow=2, byrow=T)
f508_ruseq_inf
chisq.test(f508_ruseq_inf)
f508_ruseq_ncbavd <- matrix(c(27, 3342, f508_ncbavd_ac, 10196 - f508_ncbavd_ac),
nrow=2, byrow=T)
# Non-CBAVD
f508_ncbavd_ac = round(0.0113 * 10196, digits=0)
f508_ruseq_ncbavd <- matrix(c(27, 3342, f508_ncbavd_ac, 10196 - f508_ncbavd_ac),
nrow=2, byrow=T)
f508_ruseq_ncbavd
chisq.test(f508_ruseq_ncbavd)
chisq.test(f508_reg)
chisq.test(dele23_reg)
chisq.test(dele23_reg)$residual
chisq.test(f508_dele23_reg)
chisq.test(f508_dele23_reg)$residual
chisq.test(f508_dele23_yugra_sob)
chisq.test(f508_dele23_yugra_sob)$residual
chisq.test(dele23_yugra_sob)
chisq.test(f508_reg)
chisq.test(f508_yugra_sob)
# Estimation of CI for AFs - RUSeq healthy and all
# F508del
# RUSeq healthy
binom.confint(27, 3342, method='exact', conf.level = 0.9)
library(binom)
# Estimation of CI for AFs - RUSeq healthy and all
# F508del
# RUSeq healthy
binom.confint(27, 3342, method='exact', conf.level = 0.9)
# Abramov et al.
binom.confint(15, 2000, method='exact', conf.level = 0.9)
# All variants from the table
# RUSeq healthy
binom.confint(37, 3342, method='exact', conf.level = 0.9)
# Abramov et al.
binom.confint(24, 2000, method='exact', conf.level = 0.9)
# L138ins RUSeq vs infertile
# All infertile
l138_if_ac = round(0.0015 * 12066, digits=0)
l138_ruseq_inf <- matrix(c(2, 3342, l138_if_ac, 12066 - l138_if_ac),
nrow=2, byrow=T)
l138_ruseq_inf
chisq.test(l138_ruseq_inf)
fisher.test(l138_ruseq_inf)
l138_moscow_inf <- matrix(c(0, 2654, l138_if_ac, 12066 - l138_if_ac),
nrow=2, byrow=T)
l138_moscow_inf
fisher.test(l138_moscow_inf)
#### More regions
f508_dele23_reg_all <- matrix(c(839,	281,	295,	137,	357,	73,	571,	264,	401,	157,
126,	39,	26,	14,	41,	5,	59,	24,	46, 20,
406,	160,	113,	60,	133,	189,	258,	91,	138,	46),
ncol=3, byrow=T)
#### More regions
f508_dele23_reg_all <- matrix(c(839,	295,	357,	73,	571,	264,	401,	157,
126,	26,	41,	5,	59,	24,	46, 20,
406,	113, 133,	189,	258,	91,	138,	46),
ncol=3, byrow=T)
rownames(f508_dele23_reg) <- c('Central', 'North-West', 'South', 'Caucasus',
'Volga', 'Ural', 'Siberia', 'Far East')
rownames(f508_dele23_reg_all) <- c('Central', 'North-West', 'South', 'Caucasus',
'Volga', 'Ural', 'Siberia', 'Far East')
colnames(f508_dele23_reg_all) <- c('F509del', 'CFTRdele2,3', 'other')
f508_dele23_reg_all
chisq.test(f508_dele23_reg_all)
chisq.test(f508_dele23_reg_all)$residual
#### More regions
f508_dele23_reg_all <- matrix(c(839,	295,	357,	73,	571,	264,	401,	157,
126,	26,	41,	5,	59,	24,	46, 20,
406,	113, 133,	189,	258,	91,	138,	46),
ncol=3, byrow=F)
rownames(f508_dele23_reg_all) <- c('Central', 'North-West', 'South', 'Caucasus',
'Volga', 'Ural', 'Siberia', 'Far East')
colnames(f508_dele23_reg_all) <- c('F509del', 'CFTRdele2,3', 'other')
f508_dele23_reg_all
chisq.test(f508_dele23_reg_all)
chisq.test(f508_dele23_reg_all)$residual
#### More regions
f508_dele23_reg_all <- matrix(c(839,	295,	357,	73,	571,	264,	401,	157,
126,	26,	41,	5,	59,	24,	46, 20,
645,	205,	248,	262,	502,	202,	277,	115),
ncol=3, byrow=F)
rownames(f508_dele23_reg_all) <- c('Central', 'North-West', 'South', 'Caucasus',
'Volga', 'Ural', 'Siberia', 'Far East')
colnames(f508_dele23_reg_all) <- c('F509del', 'CFTRdele2,3', 'other')
f508_dele23_reg_all
chisq.test(f508_dele23_reg_all)
chisq.test(f508_dele23_reg_all)$residual
dbinom(60, 200, 0.3)
dbinom(60, 200, 0.3)^2
dbinom(120, 200, 0.6)
dbinom(120, 200, 0.6)^
dbinom(120, 200, 0.6)^2
dbinom(100, 200, 0.5)
dbinom(100, 200, 0.5)^2
a <- matrix(c(15, 15, 25, 5), nrow=2, byrow = T)
a
chisq.test(a)
a <- matrix(c(15, 15, 24, 6), nrow=2, byrow = T)
chisq.test(a)
a <- matrix(c(4, 11, 14, 24), nrow=2)
a
chisq.test(a)
a <- matrix(c(4, 9, 14, 9), nrow=2)
chisq.test(a)
a
chisq.test(4, 14)
chisq.test(c(4, 14))
log(10)
log(2.72)
hist(log(runif(100)))
hist(-2*log(runif(100)))
hist(-2*log(runif(100)))
hist(-2*log(runif(100)))
hist(-2*log(runif(1000)))
hist(-2*log(runif(10000)))
hist(-2*log(runif(100000)))
logunif = -2*log(runif(100000))
table(logunif > 3.84)
table(logunif > 9.48)
logunif = -2*log(runif(100000))
logunif_b = -2*log(runif(100000))
table(logunif + logunif_b > 9.48)
sum(sapply(1:800000, function(x) 1/x))
467/sum(sapply(1:800000, function(x) 1/x))
log(3, 2)
10?(-1/3.32)
10^(-1/3.32)
10^(1/3.32)
source("/media/barbitoff/DATA/Working issues/FizGen/Translation and Genome/rnaseq/paper/code_revamp/All_figures.R")
ggplot(merged_de, aes(x=log2FoldChange, y=logFC)) + geom_point() +
theme_bw()
ggplot(data=proteomics_de, aes(x=logFC, y=-log10(adj.P.Val), col=regulation)) +
geom_point() + theme_bw() + geom_text_repel(aes(label = volcano_label)) +
scale_color_manual(values=c("none" = "#999999", "up" = "#E86850", "down" = "#587498"))
ggplot(deg_count, aes(x=reference, y=nGenes, fill=regulation)) +
geom_bar(stat='identity', position='dodge', col='black') +
theme_bw() + facet_wrap(~logFC_cutoff, nrow=1) +
theme(legend.position = 'top')
